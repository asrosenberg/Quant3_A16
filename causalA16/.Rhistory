library(devtools)
install.packages("devtools")
library(devtools)
source("package/prep-package.R")
source("package/prep-package.R")
source("/package/prep-package.R")
source("prep-package.R")
source("package/prep-package.R")
source("package/prep-package.R")
library(devtools)
document()
build()
install()
source("package/prep-package.R")
source("package/prep-package.R")
library(devtools)
document()
build()
install()
source("package/prep-package.R")
?source
source("causalA16/package/prep-package.R")
source(file = "causalA16/package/prep-package.R")
source(file = "package/prep-package.R")
source("package/prep-package.R")
sample.int(.Machine$integer.max, 1)
.Machine$integer.max
source("package/prep-package.R")
library(causalA16)
simulate_potential_outcomes(100)
library(causalA16)
library(causalA16)
?causalA16
simulate_potential_outcomes <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
prob_y1 <- .7
prob_y0 <- .3
DATA <- data.table(
y0 = 1 * (runif(n) < prob_y0),
y1 = 1 * (runif(n) < prob_y1))
attr(DATA, "seed") <- seed
DATA
}
simulate_simple_experiment <- function(n, prob_treatment,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_treatment := prob_treatment]
DATA[, d := 1 * (runif(n) < prob_treatment)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
}
simulate_observational_study <- function()
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_d_equals_1 := plogis(-2 + 4 * (y1 - y0))]
DATA[, d := 1 * (runif(n) < prob_d_equals_1)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
}
simulate_simple_experiment(100)
library(data.table)
simulate_simple_experiment(100)
simulate_observational_study(100)
simulate_simple_experiment <- function(n, prob_treatment = 0.5,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_treatment := prob_treatment]
DATA[, d := 1 * (runif(n) < prob_treatment)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
}
simulate_observational_study <- function(n, prob_treatment = 0.5,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_d_equals_1 := plogis(-2 + 4 * (y1 - y0))]
DATA[, d := 1 * (runif(n) < prob_d_equals_1)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
}
simulate_observational_study <- function(n, prob_treatment = 0.5,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_d_equals_1 := plogis(-2 + 4 * (y1 - y0))]
DATA[, d := 1 * (runif(n) < prob_d_equals_1)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL, prob_d_equals_1 = NULL)]
attr(DATA, "seed") <- seed
}
calculate_naive_difference_in_means <- function(DATA)
{
DATA[, mean(y[d == 1]) - mean(y[d == 0])]
}
calculate_naive_difference_in_means(simulate_simple_experiment(100))
simulate_observational_study(100)
simulate_observational_study <- function(n, prob_treatment = 0.5,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_d_equals_1 := plogis(-2 + 4 * (y1 - y0))]
DATA[, d := 1 * (runif(n) < prob_d_equals_1)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL, prob_d_equals_1 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
simulate_observational_study(100)
simulate_observational_study(10)calculate_naive_difference_in_means()
calculate_naive_difference_in_means(simulate_observational_study(10))
calculate_naive_difference_in_means(simulate_observational_study(10))
calculate_naive_difference_in_means(simulate_simple_experiment(10))
calculate_naive_difference_in_means(simulate_simple_experiment(10))
simulate_simple_experiment <- function(n, prob_treatment = 0.5,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
DATA[, prob_treatment := prob_treatment]
DATA[, d := 1 * (runif(n) < prob_treatment)]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
calculate_naive_difference_in_means(simulate_observational_study(10))
calculate_naive_difference_in_means(simulate_simple_experiment(10))
calculate_naive_difference_in_means(simulate_simple_experiment(10))
calculate_naive_difference_in_means(simulate_observational_study(10))
calculate_naive_difference_in_means(simulate_simple_experiment(10))
D1 <- simulate_observational_study(10)
D2 <- simulate_simple_experiment(10)
calculate_naive_difference_in_means(D1)
calculate_naive_difference_in_means(D2)
D1 <- simulate_observational_study(10)
D2 <- simulate_simple_experiment(10)
calculate_naive_difference_in_means(D1)
calculate_naive_difference_in_means(D2)
D1 <- simulate_observational_study(100)
D2 <- simulate_simple_experiment(100)
calculate_naive_difference_in_means(D1)
calculate_naive_difference_in_means(D2)
source("package/prep-package")
source("/package/prep-package")
library(causalA16)
library(causalA16)
source("/test")
source("dev")
source("package")
source("R")
source("R/potential-outcomes")
source("R/potential-outcomes.R")
source("package/prep-package.R")
library(devtools)
document()
build()
install()
library(devtools)
document()
build()
install()
source("package/prep-package")
source("package/prep-package.R")
source("/Users/asrosenberg90/Desktop/causalA16/package/prep-package.R")
ls("/package")
ls()
getwd()
list.files()
list.files()
source("package/prep-package.R")
library(devtools)
document()
build()
install()
n <- 19
rbinom(n, 1, prob = 0.5)
rbinom(n, 3, prob = 0.5)
u <- rbinom(n, 1, prob = 0.5)
s <- rbinom(n, 1, prob = plogis(-1 + 2 * u))
library(devtools)
document()
build()
install()
system.file("extdata",paste0(dataset,".csv"),
package = "causalA16")
system.file("extdata",paste0(fearon_laitin_03,".csv"),
package = "causalA16")
library(causalA16)
library(data.table)
library(ggplot2)
library(texreg)
dat <- load_dataset("fearon_laitin_03")
system.file("extdata", fearon_laitin_03.csv, package = "causalA16")
system.file("extdata", fearon_laitin_03.csv, package = "causalA16")
system.file("extdata", "fearon_laitin_03.csv", package = "causalA16")
dat <- load_dataset("fearon_laitin_03")
View(dat)
class(dat)
setDT(dat)
class(dat)
setkey(dat, onset)
ggplot(dat, aes(onset)) + geom_histogram() + theme_bw()
range(dat$onset)
table(dat$onset)
dat <- dat[onset < 4]
mod1 <- glm(onset ~ warl + gdpenl + lpopl1 + lmtnest + ncontig + Oil + nwstate +
instab + polity2l + ethfrac + relfrac, family = binomial(link = "logit"),
data = dat)
screenreg(mod1)
htmlreg(mod1)
texreg(mod1)
library(causalA16)
library(data.table)
library(ggplot2)
library(texreg)
dat <- load_dataset("fearon_laitin_03")
setDT(dat)
setkey(dat, onset)
ggplot(dat, aes(onset)) + geom_histogram() + theme_bw()
range(dat$onset)
table(dat$onset)
dat <- dat[onset < 4]
mod1 <- glm(onset ~ warl + gdpenl + lpopl1 + lmtnest + ncontig + Oil + nwstate +
instab + polity2l + ethfrac + relfrac, family = binomial(link = "logit"),
data = dat)
screenreg(mod1)
library(causalA16)
?simulate_simple_experiment
simulate_simple_experiment(10)
D <- simulate_simple_experiment(10)
D <- simulate_potential_experiment(10)
D <- simulate_potential_outcomes(10)
D
D <- simulate_potential_outcomes(1000)
D
sample.int(1000, 500)
treated <- sample.int(1000, 500)
control <- (1:1000)[-treated]
control
treated <- sample.int(1000, 500)
control <- (1:1000)[-treated]
treated <- sample.int(1000, 500)
control <- (1:1000)[-treated]
sort(union(treated, control))
control <- setdiff(1:1000, treated)
treated <- sample.int(1000, 500)
control <- setdiff(1:1000, treated)
D[treated, y := y1]
D[control, y := y0]
D[treated, mean(y)] - D[control, mean(y)]
library(causalA16)
set.seed(1)
D <- simulate_potential_outcomes(1000)
# now just write down all the possible treatment assignments
# sample from the randomization distribution
treated <- sample.int(1000, 500)
control <- setdiff(1:1000, treated)
D[treated, y := y1]
D[control, y := y0]
D[treated, mean(y)] - D[control, mean(y)]
View(D)
randomize(D)
randomize <- function(DATA)
{
treated <- sample.int(1000, 500)
control <- setdiff(1:1000, treated)
DATA[treated, y := y1]
DATA[control, y := y0]
DATA[treated, mean(y)] - DATA[control, mean(y)]
}
randomize(D)
d
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
set.seed(1)
D <- simulate_potential_outcomes(1000)
randomize <- function(DATA)
{
treated <- sample.int(1000, 500)
control <- setdiff(1:1000, treated)
DATA[treated, y := y1]
DATA[control, y := y0]
DATA[treated, mean(y)] - DATA[control, mean(y)]
}
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
randomize(D)
permutation_distribution <- replicate(1000, randomize(D))
mean(permutation_distribution)
sd(permutation_distribution)
hist(permutation_distribution)
permutation_distribution <- replicate(10000, randomize(D))
hist(permutation_distribution, breaks = 100)
hist(permutation_distribution, breaks = 1000)
hist(permutation_distribution, breaks = 100)
mean(permutation_distribution)
install.packages(updatr)
install.packages("installr")
3 %% 0
simulate_paired_experiment <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
stopifnot(n %% 2 == 0) # stop if n isn't even, %% is remainder
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
treated <- sample.int(n, n / 2)
control <- setdiff(n, treated)
DATA[treated, d := 1]
DATA[control, d := 0]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
experiment <- simulate_paired_experiment(1000)
experiment
experiment
simulate_paired_experiment <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
stopifnot(n %% 2 == 0) # stop if n isn't even, %% is remainder
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
treated <- sample.int(n, n / 2)
control <- setdiff(1:n, treated)
DATA[treated, d := 1]
DATA[control, d := 0]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
experiment <- simulate_paired_experiment(1000)
experiment
experiment[, .N, d]
experiment[, .N, .(d, y)]
experiment[d == 1, y1 := y]
experiment[d == 0, y0 := y]
View(experiment)
experiment[, y1 := y]
experiment[, y0 := y]
randomize(experiment)
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution)
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
abline(v = tau0, col = "cornflowerblue")
hist(permutation_distribution)
abline(v = tau0, col = "cornflowerblue")
abline(v = tau0, col = "red")
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
tau0
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution, breaks = 100)
abline(v = tau0, col = "red")
experiment <- simulate_paired_experiment(1000)
experiment[, .N, .(d, y)]
experiment[, y1 := y]
experiment[, y0 := y]
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
randomize(experiment) # distribution of differences in means estimator under sharp null
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution, breaks = 100)
abline(v = tau0, col = "red")
tau0
experiment <- simulate_paired_experiment(1000)
experiment[, .N, .(d, y)]
experiment[, y1 := y]
experiment[, y0 := y]
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
randomize(experiment) # distribution of differences in means estimator under sharp null
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution, breaks = 100)
abline(v = tau0, col = "red")
hist(permutation_distribution, breaks = 100)
hist(permutation_distribution, breaks = 100, xlim = c(-.5, .5))
abline(v = tau0, col = "red")
simulate_paired_experiment <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
stopifnot(n %% 2 == 0) # stop if n isn't even, %% is remainder
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
treated <- sample.int(n, n / 2)
control <- setdiff(1:n, treated)
DATA[treated, d := 1]
DATA[control, d := 0]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
experiment <- simulate_paired_experiment(1000)
#experiment[, .N, .(d, y)]
experiment[, y1 := y]
experiment[, y0 := y]
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
randomize(experiment) # distribution of differences in means estimator under sharp null
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution, breaks = 100, xlim = c(-.5, .5))
abline(v = tau0, col = "red")
library(causalA16)
randomize <- function(DATA)
{
treated <- sample.int(1000, 500)
control <- setdiff(1:1000, treated)
DATA[treated, y := y1]
DATA[control, y := y0]
DATA[treated, mean(y)] - DATA[control, mean(y)]
}
permutation_distribution <- replicate(10000, randomize(D))
mean(permutation_distribution)
sd(permutation_distribution)
hist(permutation_distribution, breaks = 100)
set.seed(1)
# needs documentation
simulate_paired_experiment <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
stopifnot(n %% 2 == 0) # stop if n isn't even, %% is remainder
set.seed(seed)
DATA <- simulate_potential_outcomes(n)
treated <- sample.int(n, n / 2)
control <- setdiff(1:n, treated)
DATA[treated, d := 1]
DATA[control, d := 0]
DATA[, y := d * y1 + (1 - d) * y0]
DATA[, `:=`(y1 = NULL, y0 = NULL)]
attr(DATA, "seed") <- seed
DATA
}
experiment <- simulate_paired_experiment(1000)
#experiment[, .N, .(d, y)]
experiment[, y1 := y]
experiment[, y0 := y]
tau0 <- experiment[d == 1, mean(y)] - experiment[d == 0, mean(y)]
randomize(experiment) # distribution of differences in means estimator under sharp null
permutation_distribution <- replicate(1000, randomize(experiment))
hist(permutation_distribution, breaks = 100, xlim = c(-.5, .5))
abline(v = tau0, col = "red")
experiment[d == 1, mean(y)]
experiment[d == 0, mean(y)]
experiment[, y1]
View(experiment)
n <- 1
prob_y1 <- .7
prob_y0 <- .3
runif(n) < prob_y0
y1 = 1 * (runif(n) < prob_y1))
1 * (runif(n) < prob_y1)
1 * (runif(n) < prob_y0)
runif(n)
simulate_potential_outcomes <- function(n,
seed = sample.int(.Machine$integer.max, 1))
{
set.seed(seed)
prob_y1 <- .7
prob_y0 <- .3
DATA <- data.table(
y0 = 1 * (runif(n) < prob_y0),
y1 = 1 * (runif(n) < prob_y1))
attr(DATA, "seed") <- seed
DATA
}
simulate_potential_outcomes(4)
library(data.table)
simulate_potential_outcomes(4)
simulate_potential_outcomes(4)
attr(simulate_potential_outcomes(5))
library(devtools)
document()
build()
install()
?texreg
?texreg::texreg
dataset <- fearon_laitin_03
dataset <- "fearon_laitin_03"
system.file("extdata", paste0(dataset,".csv"),
package = "causalA16")
